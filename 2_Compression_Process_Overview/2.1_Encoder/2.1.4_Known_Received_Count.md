---
title: "2.1.2. 阻塞流"
anchor: "2.1.4_Known_Received_Count"
weight: 214
rank: "h3"
---

因为QUIC不保证不同流上传输的数据之间顺序交付，解码器可能会出现表示引用了一个其尚未收到的动态表条目。

TODO：representation译为“表示”不太妥当。

每个编码的字段组包含一个插入计数下限（详见[第4.5.1章]()），即能够解码字段组所必需的最小插入计数。
对于一个使用动态表引用进行编码的字段组而言，插入计数下限大于所有被引用的动态表条目的最大绝对索引。
对于一个没有使用动态表进行编码的字段组而言，插入计数下限是零。

当解码器收到一个插入计数下限大于其插入计数的编码字段组时，流不可以立即处理，而应视为“阻塞”，详见[第2.2.1章]()。

解码器通过`SETTINGS_QPACK_BLOCKED_STREAMS`（QPACK阻塞流数设置）设定可以被阻塞的流的条数上限，详见[第5章]()。
任何时候，编码器都{{< req_level MUST >}}将可以被阻塞的流的条数限制在`SETTINGS_QPACK_BLOCKED_STREAMS`指定的限界内。
如果编码器出现阻塞流数超过其声明可以支持条数的情况，{{< req_level MUST >}}将其视为一个`QPACK_DECOMPRESSION_FAILED`（QPACK解压失败）类型连接错误。

注意，解码器可能不会在每条有阻塞风险的流上阻塞。

编码器可以决定是否冒险让一条流被阻塞。
如果`SETTINGS_QPACK_BLOCKED_STREAMS`值允许，压缩效率通常可以通过引用仍然在传输中的动态表条目而提高，但是一旦出现丢包或乱序，流可能在解码器端阻塞。
编码器可以通过只引用那些已经被确认的动态表条目从而避免阻塞风险，但是这可能意味着使用明文。
由于明文使得编码字段组变大，可能导致编码器被拥塞控制或流量控制限制所阻塞。

